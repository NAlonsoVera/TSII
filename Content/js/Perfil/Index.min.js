var OnSuccessMantenimientoClienteFacturacion,OnFailureMantenimientoClienteFacturacion,OnSuccessDireccion,OnFailureDireccion;$(function(){function i(){s();fetch("/Perfil/ListadoDireccion").then(n=>n.json()).then(n=>{n.data.forEach(n=>{const{cDireccion:f,cDistrito:e,cReferencia:i,cTelefono:r,pk_eClienteDireccionEnvio:u}=n;t.innerHTML+=`
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">  
                        <div class="card" >
                          <div class="card-body">
                            <h6 class="card-subtitle mb-2 text-muted">${f}</h6>
                            <p class="card-text">
                                <strong>Referencia:</strong> ${i!=null?i:""} </br>
                                <strong>Distrito:</strong> ${e} </br>
                                <strong>Teléfono:</strong> ${r!=null?r:""} </br>
                            </p>

                            <ul style="display:flex; list-style: none">
                                <li><button type="button" class="btnEditarDireccion btn btn-info" data-pkdireccion="${u}" >Editar</button></li>
                                <li><button type="button" class="btnEliminarDireccion btn btn-danger" data-pkdireccion="${u}" >Eliminar</button></li>
                            </ul>
                          </div>
                        </div> 
                    </div>
                    `})})}function r(n,t,i,r,f){u(t,i,"GET",function(t){t&&(n.html("<option value>"+f+"<\/option>"),$.each(t,function(t,i){n.append(`<option value="${i.Value}">${i.Text}</option>`)}),r&&r())})}function u(n,t,i,r,u,f){$.ajax({url:n,data:t,type:i,cache:!1,success:function(n){u===!0?n.Success===!0?(swal("Bien!",f?f:"Proceso realizado Correctamente","success"),r&&r(n)):swal("Algo Salio Mal!",n.Message,"error"):r&&r(n)},beforeSend:function(){u!==!0&&$("#loading").show()},complete:function(){u!==!0&&$("#loading").hide()}})}function f(t){$(".loading").show();u("/Perfil/BuscarDirrecion",{id:t},"GET",function(t){n.find("input#pk_eClienteDireccionEnvio").val(t.data.pk_eClienteDireccionEnvio);n.find("select#fk_cDepartamento").val(t.data.fk_cDepartamento);n.find("select#fk_cProvincia").html("").append("<option value="+t.data.fk_cProvincia+">"+t.data.cProvincia+"<\/option>");n.find("select#fk_cDistrito").html("").append("<option value="+t.data.fk_cDistrito+">"+t.data.cDistrito+"<\/option>");n.find("input#cTelefono").val(t.data.cTelefono);n.find("input#cDireccion").val(t.data.cDireccion);console.log(t)})}function o(n){if(event.target.type==="button"){const t=n.target.dataset.pkdireccion;n.target.classList.contains("btnEditarDireccion")?f(t):fetch(`/Perfil/EliminarDireccion?id=${parseInt(t)}`).then(n=>n.json()).then(n=>{console.log(n),n.Success&&i()})}}function s(){while(t.firstChild)t.removeChild(t.firstChild)}var e=$("#frmMantenimientoClienteDatosFacturacion"),n;const t=document.querySelector("#listadoDirecciones");OnSuccessMantenimientoClienteFacturacion=function(n){e.find("span[data-valmsg-for]").text("");n.Success?window.location.reload(!0):n.Errors&&(console.log(n.Errors),$.each(n.Errors,function(n,t){$("span[data-valmsg-for="+t.Key+"]").length!==0&&$("span[data-valmsg-for="+t.Key+"]").text(t.Message)}))};$("#btnNuevaDireccion").on("click",function(){f()});$(".btnCancelar").on("click",function(){let n=$(this).attr("data-pkPedido");$(`.divCancelar-${n}`).fadeToggle();$(this).hide()});$(".btnCancelarCancelacion").on("click",function(){let n=$(this).attr("data-pkPedido");$(`.divCancelar-${n}`).fadeToggle();$(`.btnCancelar[data-pkPedido=${n}]`).show()});$(".Select").on("change",function(){$this=$(this).val();let n=$(this).closest("#div");$this!=0?n.find(".Selected").removeAttr("disabled",!1):(n.find(".Selected").attr("disabled",!0),n.find(`btnSeguro-${n.find("input[name=pk_ePedido]").val()}`).attr("disabled",!0),n.find(".Selected").val(0))});$(".Selected").on("change",function(){$this=$(this).val();let n=$(this).closest("#div").find("input[name=pk_ePedido]").val();$this!=0?$(`.btnSeguro-${n}`).removeAttr("disabled",!1):$(`.btnSeguro-${n}`).attr("disabled",!0)});$(".toggle-password").click(function(){$(this).toggleClass("fa-eye fa-eye-slash");var n=$($(this).attr("toggle"));n.attr("type")=="password"?n.attr("type","text"):n.attr("type","password")});i();t.addEventListener("click",o);$("#fk_cDepartamento").on("change",function(){const n={};$(this).val()!==""&&(n.pk_cDepartamento=$(this).val());r($("#fk_cProvincia"),"/Perfil/ProvinciaPorDepartamento2",n,null,"Provincia")});$("#fk_cProvincia").on("change",function(){const n={};$(this).val()!==""&&(n.pk_cProvincia=$(this).val());r($("#fk_cDistrito"),"/Perfil/DistritoPorProvincia2",n,null,"Distrito")});n=$("#frmDireccionMant");OnSuccessDireccion=function(t){n.find("span[data-valmsg-for]").text("");t.Success?(n[0].reset(),i()):t.Errors&&$.each(t.Errors,function(n,t){$("span[data-valmsg-for="+t.Key+"]")[0]&&$("span[data-valmsg-for="+t.Key+"]").text(t.Message)})};OnFailureDireccion=function(){swal("Algo salió mal!","Ocurrio un error al guardar la dirección","error")}});